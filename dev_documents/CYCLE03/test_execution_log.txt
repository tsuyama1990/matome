============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
testpaths: tests
plugins: cov-7.0.0, langsmith-0.6.9, anyio-4.12.1
collected 144 items

tests/integration/test_chunking_pipeline.py .                            [  0%]
tests/integration/test_dikw_pipeline.py ...                              [  2%]
tests/integration/test_embedding_clustering_pipeline.py ..               [  4%]
tests/integration/test_full_pipeline_verification.py ....                [  6%]
tests/integration/test_hallucination_verification.py .                   [  7%]
tests/integration/test_pipeline_errors.py ....                           [ 10%]
tests/integration/test_raptor_pipeline.py .                              [ 11%]
tests/integration/test_store_concurrency.py .                            [ 11%]
tests/uat/test_cycle01_uat.py ...                                        [ 13%]
tests/uat/test_cycle02_uat.py ...                                        [ 15%]
tests/uat/test_cycle03_uat.py ...                                        [ 18%]
tests/uat/test_cycle04_uat.py ...                                        [ 20%]
tests/uat/test_cycle05_uat.py ..                                         [ 21%]
tests/uat/test_cycle06_uat.py ...                                        [ 23%]
tests/unit/test_cli.py ....                                              [ 26%]
tests/unit/test_cluster.py .....                                         [ 29%]
tests/unit/test_cluster_edge_cases.py ...                                [ 31%]
tests/unit/test_cluster_large.py .                                       [ 32%]
tests/unit/test_config_validation.py ...                                 [ 34%]
tests/unit/test_dikw_schema.py ....                                      [ 37%]
tests/unit/test_dikw_strategies.py ......                                [ 41%]
tests/unit/test_domain_models.py ......                                  [ 45%]
tests/unit/test_domain_models_cycle02.py ......                          [ 50%]
tests/unit/test_embedder.py ...                                          [ 52%]
tests/unit/test_exporter_markdown.py .                                   [ 52%]
tests/unit/test_exporter_obsidian.py ...                                 [ 54%]
tests/unit/test_interactive_engine.py ..........                         [ 61%]
tests/unit/test_interface_compliance.py .                                [ 62%]
tests/unit/test_io.py ...                                                [ 64%]
tests/unit/test_raptor.py ...                                            [ 66%]
tests/unit/test_raptor_retrieval.py .                                    [ 67%]
tests/unit/test_refinement_strategy.py ....                              [ 70%]
tests/unit/test_semantic_chunker.py .....                                [ 73%]
tests/unit/test_store_schema.py ...                                      [ 75%]
tests/unit/test_strategies.py ...                                        [ 77%]
tests/unit/test_streaming_verification.py ....                           [ 80%]
tests/unit/test_summarizer.py ........                                   [ 86%]
tests/unit/test_summarizer_dos.py ...                                    [ 88%]
tests/unit/test_text_utils.py .....                                      [ 91%]
tests/unit/test_token_chunker.py ........                                [ 97%]
tests/unit/test_verifier.py ....                                         [100%]

=============================== warnings summary ===============================
tests/integration/test_embedding_clustering_pipeline.py::test_embedding_clustering_pipeline
tests/integration/test_embedding_clustering_pipeline.py::test_real_pipeline_small
tests/integration/test_full_pipeline_verification.py::test_full_pipeline_flow
tests/integration/test_full_pipeline_verification.py::test_pipeline_streaming_logic
tests/uat/test_cycle04_uat.py::test_uat_scenario_12_multi_level
  /app/.venv/lib/python3.12/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
    warn(

tests/uat/test_cycle04_uat.py::test_uat_scenario_12_multi_level
tests/uat/test_cycle04_uat.py::test_uat_scenario_12_multi_level
tests/uat/test_cycle04_uat.py::test_uat_scenario_12_multi_level
tests/uat/test_cycle04_uat.py::test_uat_scenario_12_multi_level
tests/uat/test_cycle04_uat.py::test_uat_scenario_12_multi_level
  /app/.venv/lib/python3.12/site-packages/umap/spectral.py:548: UserWarning: Spectral initialisation failed! The eigenvector solver
  failed. This is likely due to too small an eigengap. Consider
  adding some noise or jitter to your data.

  Falling back to random initialisation!
    warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

Name                                       Stmts   Miss  Cover   Missing
------------------------------------------------------------------------
src/domain_models/__init__.py                  5      0   100%
src/domain_models/config.py                   77      3    96%   40, 207-208
src/domain_models/constants.py                13      0   100%
src/domain_models/data_schema.py              14      0   100%
src/domain_models/manifest.py                 66      9    86%   53-55, 67-69, 71-73
src/domain_models/types.py                     3      0   100%
src/domain_models/verification.py             20      1    95%   55
src/matome/__init__.py                         4      0   100%
src/matome/agents/__init__.py                  0      0   100%
src/matome/agents/strategies.py               43      3    93%   61, 84, 107
src/matome/agents/summarizer.py              159     31    81%   95-105, 133, 180-185, 191, 193, 195, 232, 276-277, 282, 320-321, 338, 341-342, 354-359
src/matome/agents/verifier.py                 91     28    69%   57, 73-74, 79-80, 85-87, 102-110, 117-118, 128, 136, 139-140, 148, 153, 155, 168-171
src/matome/cli.py                             82     12    85%   97-99, 135, 176, 182-183, 185-186, 188-189, 196
src/matome/config.py                          10      0   100%
src/matome/engines/__init__.py                 0      0   100%
src/matome/engines/chunker.py                  3      3     0%   1-4
src/matome/engines/cluster.py                189     21    89%   76, 130-131, 134-135, 157-159, 268-271, 382-385, 397, 409, 419-425
src/matome/engines/embedder.py                51      4    92%   57, 65, 88-89
src/matome/engines/interactive_raptor.py      53      0   100%
src/matome/engines/raptor.py                 162     29    82%   80, 102-103, 107-108, 157-164, 183-184, 212, 221, 239-242, 246-249, 270-271, 322-323, 328, 334-335
src/matome/engines/semantic_chunker.py        86     13    85%   62, 105, 115-117, 133-134, 153-155, 200-202
src/matome/engines/token_chunker.py           68     10    85%   32-37, 44-47, 121-126
src/matome/exceptions/__init__.py              4      0   100%
src/matome/exporters/__init__.py               3      0   100%
src/matome/exporters/markdown.py              59      8    86%   36-42, 90
src/matome/exporters/obsidian.py             122      4    97%   77, 125, 196, 243
src/matome/interfaces.py                      21      0   100%
src/matome/strategies.py                      19     19     0%   6-51
src/matome/utils/__init__.py                   0      0   100%
src/matome/utils/compat.py                    17      8    53%   30-31, 39-44
src/matome/utils/io.py                        15      0   100%
src/matome/utils/prompts.py                    5      0   100%
src/matome/utils/store.py                     98     12    88%   40-42, 71-73, 102, 144, 163, 182-186
src/matome/utils/text.py                      30      1    97%   20
------------------------------------------------------------------------
TOTAL                                       1592    219    86%
================= 144 passed, 10 warnings in 62.70s (0:01:02) ==================
/app/.venv/lib/python3.12/site-packages/coverage/inorout.py:562: CoverageWarning: Module dev_src was never imported. (module-not-imported); see https://coverage.readthedocs.io/en/7.13.3/messages.html#warning-module-not-imported
  self.warn(f"Module {pkg} was never imported.", slug="module-not-imported")
